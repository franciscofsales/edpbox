  - platform: mqtt
    name: "EB3 Load Profile"
    unique_id: EB3_Load_Profile
    state_topic: "tele/edpbox3/SENSOR"
    value_template: >-
        {% if value_json.EB3.LP_MM is defined and value_json.EB3.LP_IMP is defined %}
          {% set yy = value_json.EB3.LP_Y|int %}
          {% set mt = value_json.EB3.LP_M|int %}
          {% set dd = value_json.EB3.LP_D|int %}
          {% set hh = value_json.EB3.LP_HH|int %}
          {% set mm = value_json.EB3.LP_MM|int %}
          {% set im = value_json.EB3.LP_IMP|string %}
          {% set ex = value_json.EB3.LP_EXP|string %}
          {{ '{0:04d}'.format(yy) + "-" + '{0:02d}'.format(mt) + "-" + '{0:02d}'.format(dd) + "," + '{0:02d}'.format(hh) + ":" + '{0:02d}'.format(mm) + "," + im + "," + ex }}
        {% else %}
          {{ states('sensor.eb3_load_profile') }}
        {% endif %}
    icon: mdi:graph

  - platform: template
    sensors:

      lp_save:
        friendly_name: LP Save
        value_template: >-
            {% set a = states('sensor.eb3_import')|string %}
            {% set b = states('sensor.eb3_load_profile')|string %}
            {{ b + ',' + a }}
      icon: mdi:graph

#EOF
